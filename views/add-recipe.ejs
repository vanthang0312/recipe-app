<%- include('partials/header') %>

<div class="container py-5 min-vh-100 add">
  <div class="row justify-content-center">
    <div class="col-lg-10 add__hero text-center mb-5">
      <p class="text-uppercase fw-bold small text-danger add__eyebrow">
        <i class="fas fa-fire me-2"></i>Chia sẻ món ngon của bạn
      </p>
      <h1 class="display-4 fw-bold add__title">Thêm công thức mới</h1>
      <p class="lead text-muted col-lg-8 mx-auto add__subtitle">
        Điền đầy đủ nguyên liệu, bước làm và hình ảnh để mọi người có thể làm theo nhanh nhất.
      </p>
    </div>
  </div>

  <div class="row justify-content-center">
    <div class="col-lg-9 col-xl-8">
      <div class="card shadow-lg border-0 rounded-4 overflow-hidden add__form-card">
        <div class="card-body p-5 add__form-body">
          <% if (typeof error_msg !== 'undefined' && error_msg) { %>
          <div class="alert alert-danger rounded-4 d-flex align-items-center mb-4">
            <i class="fas fa-exclamation-triangle me-3 fs-4"></i>
            <div><%= error_msg %></div>
          </div>
          <% } %>

          <form
            id="add__form"
            method="POST"
            action="/recipes/add"
            enctype="multipart/form-data"
            novalidate
          >
            <!-- Upload ảnh -->
            <div class="mb-5 add__field">
              <label class="form-label fw-bold text-danger fs-5 add__label">
                <i class="fas fa-camera"></i>
                Ảnh món ăn (bắt buộc)
              </label>
              <div class="upload-dropzone" id="upload-dropzone">
                <input
                  id="upload-dropzone__input"
                  type="file"
                  name="recipeImage"
                  accept="image/*"
                  required
                  class="upload-dropzone__input"
                />
                <div id="upload-dropzone__preview" class="text-center">
                  <i class="fas fa-cloud-upload-alt text-danger upload-dropzone__icon"></i>
                  <p class="fw-bold text-danger fs-4 mb-1">Chọn ảnh để tải lên</p>
                  <small class="text-muted d-block">JPG, PNG, WebP tối đa 5MB</small>
                </div>
              </div>
            </div>

            <!-- Tiêu đề -->
            <div class="mb-4 add__field">
              <label class="form-label fw-bold text-danger fs-5 add__label" for="add__title">
                Tiêu đề món ăn
              </label>
              <input
                id="add__title"
                type="text"
                name="title"
                class="form-control form-control-lg rounded-pill shadow-sm"
                placeholder="VD: Phở bò Hà Nội truyền thống"
                required
              />
            </div>

            <!-- Mô tả -->
            <div class="mb-4 add__field">
              <label class="form-label fw-bold text-danger add__label" for="add__description">
                Mô tả ngắn (tùy chọn)
              </label>
              <textarea
                id="add__description"
                name="description"
                class="form-control rounded-3"
                rows="3"
                placeholder="Món phở gia truyền 3 đời, nước dùng ninh từ xương bò tươi..."
              ></textarea>
            </div>

            <!-- Video -->
            <div class="mb-5 add__field">
              <label class="form-label fw-bold text-danger fs-5 add__label" for="add__video">
                <i class="fas fa-video me-2"></i>Video hướng dẫn (YouTube/Vimeo) - tùy chọn
              </label>
              <div class="input-group input-group-lg">
                <span class="input-group-text bg-danger text-white">
                  <i class="fab fa-youtube"></i>
                </span>
                <input
                  id="add__video"
                  type="url"
                  name="video"
                  class="form-control rounded-end shadow-sm"
                  placeholder="https://www.youtube.com/watch?v=abc123 hoặc https://youtu.be/abc123"
                />
              </div>
              <div class="form-text mt-2">
                Dán link YouTube hoặc Vimeo, hoặc để trống nếu không có video.
              </div>
            </div>

            <!-- Nguyên liệu -->
            <div class="mb-4 add__field">
              <label class="form-label fw-bold text-danger fs-5 add__label" for="add__ingredients">
                Nguyên liệu (mỗi dòng 1 thành phần)
              </label>
              <textarea
                id="add__ingredients"
                name="ingredients"
                class="form-control rounded-3"
                rows="8"
                required
                placeholder="500g thịt bò&#10;300g bánh phở tươi&#10;2kg xương bò&#10;Hành lá, rau thơm, gia vị..."
              ></textarea>
            </div>

            <!-- Cách làm -->
            <div class="mb-5 add__field">
              <label class="form-label fw-bold text-danger fs-5 add__label" for="add__steps">
                Cách làm (mỗi dòng 1 bước)
              </label>
              <textarea
                id="add__steps"
                name="instructions"
                class="form-control rounded-3"
                rows="12"
                required
                placeholder="Sơ chế bước 1...&#10;Nấu nước dùng bước 2...&#10;..."
              ></textarea>
            </div>

            <div class="d-grid">
              <button
                type="submit"
                class="btn btn-danger btn-lg rounded-pill fw-bold shadow-lg add__submit"
              >
                <i class="fas fa-upload me-2"></i>Đăng công thức
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('partials/footer') %>

<script src="/js/add-recipe.js"></script>
